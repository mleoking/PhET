<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="Release With Lib" name="General Ant Build Script">
    <property file="build.number"/>
    <property value="../.." name="project_home"/>
    <property name="ant.output" value="${project_home}/ant_output"/>
    <property name="classes" location="${ant.output}/classes"/>
    <property name="jars" location="${ant.output}/jars/"/>
    <property name="javadoc" location="${ant.output}/javadoc"/>
    <property name="lib" location="${ant.output}/lib"/>
    <property name="development" location="${project_home}/development"/>
    <property name="backup" location="${project_home}/backup"/>
    <property name="releases" location="${project_home}/releases"/>
    <property name="src" location="${project_home}/development/src"/>
    <property name="data" location="${project_home}/development/data"/>
    <description>
                Build File.
            </description>
    <target name="init">
        <tstamp/>
    </target>
    <target depends="init" name="Backup Source">
        <mkdir dir="${backup}"/>
        <tstamp>
            <format locale="en" pattern="d-MMMM-yyyy h-maa" property="backup.time"/>
        </tstamp>
        <mkdir dir="${backup}/src_${backup.time}"/>
        <copy todir="${backup}/src_${backup.time}">
            <fileset dir="${src}"/>
        </copy>
    </target>
    <target depends="init" name="Backup Development">
        <mkdir dir="${backup}"/>
        <tstamp>
            <format locale="en" pattern="d-MMMM-yyyy h-maa" property="backup.time"/>
        </tstamp>
        <mkdir dir="${backup}/dev_${backup.time}"/>
        <copy todir="${backup}/dev_${backup.time}">
            <fileset dir="${development}"/>
        </copy>
    </target>
    <target description="clean up" name="Clean">
        <delete dir="${classes}"/>
        <delete dir="${jars}"/>
        <delete dir="${javadoc}"/>
        <delete dir="{lib}"/>
    </target>
    <target description="compile the source " depends="init" name="Compile">
        <delete dir="${classes}"/>
        <mkdir dir="${classes}"/>
        <javac srcdir="${src}" destdir="${classes}"/>
    </target>
    <target description="generate the distribution" depends="Compile" name="Generate Jar">
        <delete dir="${jars}"/>
        <mkdir dir="${jars}"/>
        <buildnumber/>
        <jar destfile="${jars}/greenhouse.jar">
            <fileset dir="${classes}"/>
            <fileset dir="${data}"/>
            <manifest>
                <attribute name="Built-by" value="${user.name}"/>
                <attribute name="version" value="0.1"/>
                <attribute name="build" value="${build.number}"/>
                <attribute name="Main-Class" value="edu.colorado.phet.greenhouse.GreenhouseApplication"/>
            </manifest>
        </jar>
    </target>
    <target name="Javadoc">
        <delete dir="${javadoc}"/>
        <javadoc destdir="${javadoc}" author="true" version="true" use="true">
            <packageset dir="${src}" defaultexcludes="yes"/>
            <bottom>&lt;i&gt;Copyright &amp;#169; 2003 PhET, R&amp;S Software. All Rights Reserved.&lt;/i&gt;</bottom>
            <link href="http://java.sun.com/products/jdk/1.4/docs/api/"/>
        </javadoc>
    </target>
    <target description="generate the release distribution, including binary, source and docs" depends="Generate Jar,Javadoc" name="Release With Lib">
        <mkdir dir="${releases}"/>
        <mkdir dir="${releases}/greenhouse0.1_build-${build.number}"/>
        <mkdir dir="${releases}/greenhouse0.1_build-${build.number}/src"/>
        <mkdir dir="${releases}/greenhouse0.1_build-${build.number}/bin"/>
        <mkdir dir="${releases}/greenhouse0.1_build-${build.number}/javadoc"/>
        <copy todir="${releases}/greenhouse0.1_build-${build.number}">
            <fileset casesensitive="yes" dir=".">
                <include name="*.txt"/>
                <include name="*.xml"/>
                <include name="*.properties"/>
            </fileset>
        </copy>
        <copy todir="${releases}/greenhouse0.1_build-${build.number}/bin">
            <fileset dir="${jars}"/>
        </copy>
        <copy todir="${releases}/greenhouse0.1_build-${build.number}/javadoc">
            <fileset dir="${javadoc}"/>
        </copy>
        <copy todir="${releases}/greenhouse0.1_build-${build.number}/scr">
            <filterset>
                <filter token="ant_header" value="This file is part ofGreenhouse.${line.separator}${line.separator}Greenhouseis free software; you can redistribute it and/or modify${line.separator}it under the terms of the GNU General Public License as published by${line.separator}the Free Software Foundation; either version 2 of the License, or${line.separator}(at your option) any later version.${line.separator}${line.separator}Greenhouse is distributed in the hope that it will be useful,${line.separator}but WITHOUT ANY WARRANTY; without even the implied warranty of${line.separator}MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the${line.separator}GNU General Public License for more details.${line.separator}${line.separator}You should have received a copy of the GNU General Public License${line.separator}along with Foobar; if not, write to the Free Software${line.separator}Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA${line.separator}${line.separator}Copyright ${user.name}, 2003"/>
            </filterset>
            <fileset dir="${src}"/>
        </copy>
        <copyclasspath directory="${releases}/greenhouse0.1_build-${build.number}/lib" ignore="c:/intellij-idea-3.0.4/jre/lib/tools.jar;C:/IntelliJ-IDEA-3.0.4/lib/idea_rt.jar;C:/IntelliJ-IDEA-3.0.4/lib/ant.jar;C:/IntelliJ-IDEA-3.0.4/lib/optional.jar;C:/IntelliJ-IDEA-3.0.4/lib//rt/xerces1.jar;C:/PhET/util/build/antScriptTest0.0.7_build-18/bin/antScriptTest.jar;C:/PhET/util/build/antScriptTest0.0.7_build-18/lib/ant.jar"/>
    </target>
    <taskdef classname="org.reids.anttasks.CopyClasspath" name="copyclasspath"/>
    <target name="Copy Classpath To lib">
        <delete dir="${lib}"/>
        <copyclasspath directory="${lib}" ignore="c:/intellij-idea-3.0.4/jre/lib/tools.jar;C:/IntelliJ-IDEA-3.0.4/lib/idea_rt.jar;C:/IntelliJ-IDEA-3.0.4/lib/ant.jar;C:/IntelliJ-IDEA-3.0.4/lib/optional.jar;C:/IntelliJ-IDEA-3.0.4/lib//rt/xerces1.jar;C:/PhET/util/build/antScriptTest0.0.7_build-18/bin/antScriptTest.jar;C:/PhET/util/build/antScriptTest0.0.7_build-18/lib/ant.jar"/>
    </target>
    <target name="Output Classpath to File">
        <echo file="classpath.output.txt" message="${java.class.path}"/>
    </target>
</project>
