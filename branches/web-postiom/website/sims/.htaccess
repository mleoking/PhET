#
# HTACCESS file for remapping old simulations to new
#
#
# This has been refactored to use the rewrite engine, which is more
# powerful and gives the flexibility needed to handle the various
# redirects needed during the IOM transition period, as well as pre
# and post.
#
# The engine is engine is extremely powerful at the cost of being
# extremely complex.  Be *very* careful when making edits in here.  A
# badly formed command can stop everything from working at best, and
# hork things in a not-so-immediately-obvious fashion.  It is
# recommended to add new items to the bottom, and only if you must.
#
# Many of the file checks should be removed after all the sims have
# been redeployed for IOM and deemed "safe" (will not be reverted).
#

# Put in a quarter and...
RewriteEngine on

# Base directory that the rules direct to

# This should be relative to the DOCUMENT_ROOT, which means /sims on
# tigercat.  On your dev machine it will probably be something
# different.  If you change this, DO NOT check it back in!
RewriteBase /sims

# If the request is a file or directory and it exists, we're done
# These add overhead but are important for a seamless pre->post IOM release
# Remove these after ALL sims have been re-released
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule .* %{REQUEST_FILENAME} [L]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule .* %{REQUEST_FILENAME} [L]

# Convert all requests for old project names, check the new file exists
# ex: balloons.jar -> balloons_all.jar
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/$1_all.jar -f
RewriteRule ^([-a-z0-9/]+)\.jar$ $1_all.jar [L,R=permanent]

#ex: balloons.jnlp -> balloons_en.jnlp
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/$1_en.jnlp -f
RewriteRule ^([-a-z0-9/]+)\.jnlp$ $1_en.jnlp [L,R=permanent]

# Redirect all former simulation JAR requests to the new project_all.jar
# ex: davisson-germer.jar -> quantum-wave-interference_all.jar
#RewriteRule ^balloons/balloons.jar$ balloons/balloons_all.jar [L,R=permanent]
RewriteRule ^balloons/balloons_all_unsigned.jar$ balloons/balloons_all.jar [L,R=permanent]
#RewriteRule ^battery-voltage/battery-voltage.jar$ battery-voltage/battery-voltage_all.jar [L,R=permanent]
RewriteRule ^bound-states/band-structure.jar$ bound-states/bound-states_all.jar [L,R=permanent]
#RewriteRule ^bound-states/bound-states.jar$ bound-states/bound-states_all.jar [L,R=permanent]
RewriteRule ^bound-states/covalent-bonds.jar$ bound-states/bound-states_all.jar [L,R=permanent]
RewriteRule ^circuit-construction-kit/circuit-construction-kit-ac.jar$ circuit-construction-kit/circuit-construction-kit_all.jar [L,R=permanent]
RewriteRule ^circuit-construction-kit/circuit-construction-kit-dc.jar$ circuit-construction-kit/circuit-construction-kit_all.jar [L,R=permanent]
#RewriteRule ^circuit-construction-kit/circuit-construction-kit.jar$ circuit-construction-kit/circuit-construction-kit_all.jar [L,R=permanent]
#RewriteRule ^color-vision/color-vision.jar$ color-vision/color-vision_all.jar [L,R=permanent]
#RewriteRule ^conductivity/conductivity.jar$ conductivity/conductivity_all.jar [L,R=permanent]
#RewriteRule ^discharge-lamps/discharge-lamps.jar$ discharge-lamps/discharge-lamps_all.jar [L,R=permanent]
#RewriteRule ^distance-ladder/distance-ladder.jar$ distance-ladder/distance-ladder_all.jar [L,R=permanent]
#RewriteRule ^distance-ladder/distance-ladder_all.jar$ distance-ladder/distance-ladder_all.jar [L,R=permanent]
#RewriteRule ^eating-and-exercise/eating-and-exercise.jar$ eating-and-exercise/eating-and-exercise_all.jar [L,R=permanent]
#RewriteRule ^efield/efield.jar$ efield/efield_all.jar [L,R=permanent]
#RewriteRule ^electric-hockey/electric-hockey.jar$ electric-hockey/electric-hockey_all.jar [L,R=permanent]
#RewriteRule ^energy-skate-park/energy-skate-park.jar$ energy-skate-park/energy-skate-park_all.jar [L,R=permanent]
#RewriteRule ^faraday/faraday.jar$ faraday/faraday_all.jar [L,R=permanent]
RewriteRule ^faraday/generator.jar$ faraday/faraday_all.jar [L,R=permanent]
RewriteRule ^faraday/magnet-and-compass.jar$ faraday/faraday_all.jar [L,R=permanent]
RewriteRule ^faraday/magnets-and-electromagnets.jar$ faraday/faraday_all.jar [L,R=permanent]
#RewriteRule ^forces-1d/forces-1d.jar$ forces-1d/forces-1d_all.jar [L,R=permanent]
#RewriteRule ^fourier/fourier.jar$ fourier/fourier_all.jar [L,R=permanent]
#RewriteRule ^glaciers/glaciers.jar$ glaciers/glaciers_all.jar [L,R=permanent]
#RewriteRule ^greenhouse/greenhouse.jar$ greenhouse/greenhouse_all.jar [L,R=permanent]
#RewriteRule ^hydrogen-atom/hydrogen-atom.jar$ hydrogen-atom/hydrogen-atom_all.jar [L,R=permanent]
RewriteRule ^ideal-gas/balloons-and-buoyancy.jar$ ideal-gas/ideal-gas_all.jar [L,R=permanent]
RewriteRule ^ideal-gas/diffusion.jar$ ideal-gas/ideal-gas_all.jar [L,R=permanent]
RewriteRule ^ideal-gas/gas-properties.jar$ ideal-gas/ideal-gas_all.jar [L,R=permanent]
#RewriteRule ^ideal-gas/ideal-gas.jar$ ideal-gas/ideal-gas_all.jar [L,R=permanent]
RewriteRule ^ideal-gas/reversible-reactions.jar$ ideal-gas/ideal-gas_all.jar [L,R=permanent]
#RewriteRule ^lasers/lasers.jar$ lasers/lasers_all.jar [L,R=permanent]
#RewriteRule ^maze-game/maze-game.jar$ maze-game/maze-game_all.jar [L,R=permanent]
#RewriteRule ^microwaves/microwaves.jar$ microwaves/microwaves_all.jar [L,R=permanent]
#RewriteRule ^motion-2d/motion-2d.jar$ motion-2d/motion-2d_all.jar [L,R=permanent]
RewriteRule ^moving-man/mm-motion.jar$ moving-man/moving-man_all.jar [L,R=permanent]
RewriteRule ^moving-man/moving-man-position.jar$ moving-man/moving-man_all.jar [L,R=permanent]
#RewriteRule ^moving-man/moving-man.jar$ moving-man/moving-man_all.jar [L,R=permanent]
#RewriteRule ^mri/mri.jar$ mri/mri_all.jar [L,R=permanent]
RewriteRule ^nuclear-physics/alpha-decay.jar$ nuclear-physics/nuclear-physics_all.jar [L,R=permanent]
RewriteRule ^nuclear-physics/alpha-radiation.jar$ nuclear-physics/nuclear-physics_all.jar [L,R=permanent]
RewriteRule ^nuclear-physics/nuclear-fission.jar$ nuclear-physics/nuclear-physics_all.jar [L,R=permanent]
RewriteRule ^nuclear-physics/nuclear-fission_all.jar$ nuclear-physics/nuclear-physics_all.jar [L,R=permanent]
#RewriteRule ^nuclear-physics/nuclear-physics.jar$ nuclear-physics/nuclear-physics_all.jar [L,R=permanent]
#RewriteRule ^optical-quantum-control/optical-quantum-control.jar$ optical-quantum-control/optical-quantum-control_all.jar [L,R=permanent]
RewriteRule ^optical-tweezers/molecular-motors.jar$ optical-tweezers/optical-tweezers_all.jar [L,R=permanent]
#RewriteRule ^optical-tweezers/optical-tweezers.jar$ optical-tweezers/optical-tweezers_all.jar [L,R=permanent]
RewriteRule ^optical-tweezers/stretching-dna.jar$ optical-tweezers/optical-tweezers_all.jar [L,R=permanent]
#RewriteRule ^ph-scale/ph-scale.jar$ ph-scale/ph-scale_all.jar [L,R=permanent]
#RewriteRule ^photoelectric/photoelectric.jar$ photoelectric/photoelectric_all.jar [L,R=permanent]
#RewriteRule ^quantum-tunneling/quantum-tunneling.jar$ quantum-tunneling/quantum-tunneling_all.jar [L,R=permanent]
RewriteRule ^quantum-wave-interference/davisson-germer.jar$ quantum-wave-interference/quantum-wave-interference_all.jar [L,R=permanent]
#RewriteRule ^quantum-wave-interference/quantum-wave-interference.jar$ quantum-wave-interference/quantum-wave-interference_all.jar [L,R=permanent]
#RewriteRule ^radio-waves/radio-waves.jar$ radio-waves/radio-waves_all.jar [L,R=permanent]
#RewriteRule ^reactions-and-rates/reactions-and-rates.jar$ reactions-and-rates/reactions-and-rates_all.jar [L,R=permanent]
#RewriteRule ^rotation/rotation.jar$ rotation/rotation_all.jar [L,R=permanent]
RewriteRule ^rotation/rotation_1_01.jar$ rotation/rotation_all.jar [L,R=permanent]
RewriteRule ^rotation/test-interleaved.jar$ rotation/rotation_all.jar [L,R=permanent]
RewriteRule ^rotation/torque.jar$ rotation/rotation_all.jar [L,R=permanent]
#RewriteRule ^rutherford-scattering/rutherford-scattering.jar$ rutherford-scattering/rutherford-scattering_all.jar [L,R=permanent]
#RewriteRule ^self-driven-particle-model/self-driven-particle-model.jar$ self-driven-particle-model/self-driven-particle-model_all.jar [L,R=permanent]
#RewriteRule ^semiconductor/semiconductor.jar$ semiconductor/semiconductor_all.jar [L,R=permanent]
#RewriteRule ^signal-circuit/signal-circuit.jar$ signal-circuit/signal-circuit_all.jar [L,R=permanent]
#RewriteRule ^soluble-salts/soluble-salts.jar$ soluble-salts/soluble-salts_all.jar [L,R=permanent]
#RewriteRule ^sound/sound.jar$ sound/sound_all.jar [L,R=permanent]
RewriteRule ^states-of-matter/interaction-potential.jar$ states-of-matter/states-of-matter_all.jar [L,R=permanent]
#RewriteRule ^states-of-matter/states-of-matter.jar$ states-of-matter/states-of-matter_all.jar [L,R=permanent]
#RewriteRule ^the-ramp/the-ramp.jar$ the-ramp/the-ramp_all.jar [L,R=permanent]
#RewriteRule ^travoltage/travoltage.jar$ travoltage/travoltage_all.jar [L,R=permanent]
#RewriteRule ^wave-interference/wave-interference.jar$ wave-interference/wave-interference_all.jar [L,R=permanent]

# ohm-1d changed to batter-resistor-circuit
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/battery-resistor-circuit/battery-resistor-circuit$1 -f
RewriteRule ^ohm-1d/ohm-1d(.*)$ battery-resistor-circuit/battery-resistor-circuit$1 [L,R=permanent]
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/battery-resistor-circuit/battery-resistor-circuit_all.jar -f
RewriteRule ^ohm-1d/ohm-1d.jar$ battery-resistor-circuit/battery-resistor-circuit_all.jar [L,R=permanent]
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/battery-resistor-circuit/battery-resistor-circuit_en.jnlp -f
RewriteRule ^ohm-1d/ohm-1d.jnlp$ battery-resistor-circuit/battery-resistor-circuit_en.jnlp [L,R=permanent]
RewriteCond %{DOCUMENT_ROOT}/rewrite/sims-enhanced-htaccess-new-sims/battery-resistor-circuit/ -d
RewriteRule ^ohm-1d/?$ battery-resistor-circuit/ [L,R=permanent]

# fluorescent-lights changed to discharge-lamps
RewriteRule ^fluorescent-lights/fluorescent-lights.jar$ discharge-lamps/discharge-lamps.jar [L,R=permanent]
RewriteRule ^fluorescent-lights/fluorescent-lights.jnlp$ discharge-lamps/discharge-lamps.jnlp [L,R=permanent]
RewriteRule ^fluorescent-lights/fluorescent-lights_all.jar$ discharge-lamps/discharge-lamps.jar [L,R=permanent]
RewriteRule ^fluorescent-lights/fluorescent-lights_es.jnlp$ discharge-lamps/discharge-lamps_es.jnlp [L,R=permanent]
RewriteRule ^fluorescent-lights/fluorescent-lights_pt.jnlp$ discharge-lamps/discharge-lamps_pt.jnlp [L,R=permanent]
RewriteRule ^fluorescent-lights(.*)$ discharge-lamps$1 [L,R=permanent]

# qwi changed to quantum-wave-interference
RewriteRule ^qwi/qwi-dg.jar$ quantum-wave-interference/davisson-germer.jar [L,R=permanent]
RewriteRule ^qwi/qwi-dg.jnlp$ quantum-wave-interference/davisson-germer.jnlp [L,R=permanent]
RewriteRule ^qwi/qwi-dg_el.jnlp$ quantum-wave-interference/davisson-germer_el.jnlp [L,R=permanent]
RewriteRule ^qwi/qwi-dg_pt.jnlp$ quantum-wave-interference/davisson-germer_pt.jnlp [L,R=permanent]
RewriteRule ^qwi/qwi.jar$ quantum-wave-interference/quantum-wave-interference.jar [L,R=permanent]
RewriteRule ^qwi/qwi.jnlp$ quantum-wave-interference/quantum-wave-interference.jnlp [L,R=permanent]
RewriteRule ^qwi/qwi_all.jar$ quantum-wave-interference/quantum-wave-interference.jar [L,R=permanent]
RewriteRule ^qwi/qwi_el.jnlp$ quantum-wave-interference/quantum-wave-interference_el.jnlp [L,R=permanent]
RewriteRule ^qwi/qwi_pt.jnlp$ quantum-wave-interference/quantum-wave-interference_pt.jnlp [L,R=permanent]
RewriteRule ^qwi(.*)$ quantum-wave-interference$1 [L,R=permanent]

# waveinterference changed to wave-interference
RewriteRule ^waveinterference/waveinterference.jar$ wave-interference/wave-interference.jar [L,R=permanent]
RewriteRule ^waveinterference/waveinterference.jnlp$ wave-interference/wave-interference.jnlp [L,R=permanent]
RewriteRule ^waveinterference/waveinterference_all.jar$ wave-interference/wave-interference.jar [L,R=permanent]
RewriteRule ^waveinterference/waveinterference_es.jnlp$ wave-interference/wave-interference_es.jnlp [L,R=permanent]
RewriteRule ^waveinterference/waveinterference_pt.jnlp$ wave-interference/wave-interference_pt.jnlp [L,R=permanent]
RewriteRule ^waveinterference/waveinterference_sr.jnlp$ wave-interference/wave-interference_sr.jnlp [L,R=permanent]
RewriteRule ^waveinterference/waveinterference_sv.jnlp$ wave-interference/wave-interference_sv.jnlp [L,R=permanent]
RewriteRule ^waveinterference(.*)$ wave-interference$1 [L,R=permanent]

# cck changed to circuit-construction-kit
RewriteRule ^cck/cck.jar$ circuit-construction-kit/circuit-construction-kit.jar [L,R=permanent]
RewriteRule ^cck/cck_all.jar$ circuit-construction-kit/circuit-construction-kit.jar [L,R=permanent]
RewriteRule ^cck/cck(.*)$ circuit-construction-kit/circuit-construction-kit$1 [L,R=permanent]
RewriteRule ^cck(.*)$ circuit-construction-kit$1 [L,R=permanent]

# Redirects for Nuclear Physics, which was split into Nuclear Fission and Alpha Decay in September 2008.
# Adaped and enhanced from their original versions, they were causing problems with the new project names
RewriteRule ^nuclear-physics/nuclear-physics.jnlp$ nuclear-physics/nuclear-fission.jnlp [L,R=permanent]
RewriteRule ^nuclear-physics/nuclear-physics_(..)\.(.*)$ nuclear-physics/nuclear-fission_$1.$2 [L,R=permanent]

# Misc really really old sims that still get requests, take them to the sim page rather than the sim
RewriteRule ^black-body-radiation/black-body-radiation.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Blackbody_Spectrum [L,R=permanent]
RewriteRule ^lens/lens.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Geometric_Optics [L,R=permanent]
RewriteRule ^veqir/veqir.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Ohms_Law [L,R=permanent]
RewriteRule ^curve-fit/curve-fit.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Curve_Fitting [L,R=permanent]
RewriteRule ^faraday-mx/faraday-mx.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Faradays_Law [L,R=permanent]
RewriteRule ^stern-gerlacher/stern-gerlach.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Stern_Gerlach [L,R=permanent]
RewriteRule ^string-wave/string-wave.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Wave_on_a_String [L,R=permanent]
RewriteRule ^vector-math/vector-math.swf$ http://localhost/PhET-postiom/website/simulations/sims.php?sim=Vector_Addition [L,R=permanent]
