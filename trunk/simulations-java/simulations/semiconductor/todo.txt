Fix the current gate implementation, it is wrong in many physical ways.