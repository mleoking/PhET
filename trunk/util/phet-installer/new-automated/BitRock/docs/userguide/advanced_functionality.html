
<style type="text/css"><!-- @import url("userguide.css"); --> </style>
<head><title>Advanced Functionality</title></head>
<body>
<center>
<table id="frame" border="0" cellpadding="20">	
<tr><td valign="top" cellpadding="0"><div id="content_left"><ul id="table_of_contents"><li><a href="overview.html">Overview</a></li><li><a href="features.html">Features</a></li><li><a href="what's_new_on_installbuilder_5.html">What's new on InstallBuilder 5</a></li><li><a href="specifications.html">Specifications</a></li><li><a href="how_to_register.html">How to Register</a></li><li><a href="installing_bitrock_installbuilder.html">Installing BitRock InstallBuilder</a></li><li><a href="building_your_first_installer.html">Building Your First Installer</a></li><li>Advanced Functionality</li><li><a href="actions.html">Actions</a></li><li><a href="custom_pages.html">Custom Pages</a></li><li><a href="conditional_evaluation.html">Conditional Evaluation</a></li><li><a href="running_the_installer.html">Running the Installer</a></li><li><a href="appendix.html">Appendix</a></li></ul></div></td><td valign="top">
<table border="0" cellpadding="0" cellspacing="0" align="center" style="margin-left:auto;margin-right:auto" >
  <tr><td>
<div id="content_right"><h1>Advanced Functionality</h1>

<p>This section explains how to customize the generated installers in different ways.
The first thing you should know about are installer variables.
They can be included in different settings as <code>${variablename}</code> and they will be
substituted for their values during installation.</p>

<p>For example, if you write the default installation directory as <code>/opt/${shortName}-${version}</code>
then during installation time the user will see <code>/opt/sample-1.0</code>  If you update the product version to 2.0 later on, the change will
be reflected automatically. So whenever possible, avoid hardcoding references and use installer variables instead.</p>

<p>Starting with InstallBuilder 5, variables are case-insentitive. This means that you can use any of the following variants, <code>${variablename}</code>, <code>${VariableName}</code> or <code>${VARIABLENAME}</code>,
obtaining exactly the same value on each case.</p>

<p>The current version of InstallBuilder supports the following installer variables.</p>

<ul>
<li><b>${installdir}</b>: Directory where the product will be installed.</li>
<li><b>${product_fullname}</b>: Product Name. The full product name, as it will be displayed in the installer</li>
<li><b>${product_shortname}</b>: Product Filename. Short version of product name, will be used for naming certain directories and files, and can only contain alphanumeric characters</li>
<li><b>${product_version}</b>: Version Number.</li>
<li><b>${platform_install_prefix}</b>: Platform-dependent default installation location. In Unix systems, when running as root it will be <code>/opt</code> and when running as a regular user, the home directory for that user.</li>
<li><b>${platform_exec_suffix}</b>: Platform-dependent executable file extension for the generated installer. In Unix systems it is <code>.bin</code>, on Windows it is <code>.exe</code>, and on OSX it is <code>.app</code></li>
<li><b>${platform_name}</b>: Target platform for the installer. Currently
it can be <code>linux</code>, <code>linux-ppc</code>,
<code>linux-x64</code>, <code>linux-ia64</code>, <code>linux-s390</code>,
<code>freebsd</code>, <code>freebsd4</code>, <code>freebsd6</code>, <code>freebsd6-x64</code>,
<code>solaris-sparc</code>, <code>solaris-intel</code>,
<code>irix-n32</code>, <code>osx</code>, <code>windows</code>,
<code>aix</code> or <code>hpux</code>.</li> 
<li><b>${linux_distribution}</b>: When the installer is running on Linux, it will contain the specific Linux flavor name. Currently, one of <code>debian</code>, <code>suse</code>, <code>mandrake</code>, <code>redhat</code>, <code>rhel</code><code>fedora</code>, <code>slackware</code> or <code>unknown</code> for another distribution.</li>
<li><b>${installation_langcode}</b>: The ISO code for the language the installer was run with.</li>
<li><b>${installer_is_root_install}</b>: Whether the installer is being run as root or not.</li>
<li><b>${installer_ui}</b>: Whether the installer is being run in 'text', 'gui' or 'unattended' mode.</li>
<li><b>${installer_directory}</b>: Directory where the installer binary is located.</li>
<li><b>${machine_hostname}</b>: Machine hostname</li>
<li><b>${machine_ipaddr}</b>: Machine IP address (derived from the hostname)</li>
<li><b>${required_diskspace}</b>: Required size in KB of the files that will be installed. Only files in components that are selected for installation will be taken into account when making the calculation. Notice also that this reports the size in KB of the files, not the actual disk space that will be taken, which may vary depending on the block size of the target filesystem.</li>
<li><b>${system_username}</b>: The name of the user who is running the installer.</li>
<li><b>${system_temp_directory}</b>: Path to the system's temporary directory.</li>
<li><b>${user_home_directory}</b>: Path to the home directory of the user who is running the installer.</li>
</ul>

<p>Additionally, it is possible to access any environment variable using the ${env(<i>varname</i>)} construct, where <i>varname</i> is the name
of an environment variable. For example, on Windows you can refer to the
system drive with ${env(SYSTEMDRIVE)} and in Linux, Mac OS X and other Unix
systems to the user home directory
with ${env(HOME)}</p>

<h2>Installer Customization</h2>

<p>In the Customization (Figure 18) and the Packaging screens you can change the default installation settings to 
match your needs:</p>

<h3>User Interface Settings</h3>
<ul>
<li><b>Logo image</b>: 48x48 GIF or PNG logo image that will be placed at the top right corner of the installer. If no image is specified, the default one will be used</li>
<li><b>Left side image</b>: 163x314 GIF or PNG image that will be placed at the left side of the installer in the Welcome and Installation Finished pages. If no image is specified, the default one will be used</li>
<li><b>Windows Executable Icon</b>: ICO file with an specific format -see below- to set the icon for the installer executable file on Windows systems. The icon file can contain up to three different icons that must match one of the following formats: 16x16 pixels and 256 colors, 32x32 pixels and 256 colors, 48x48 pixels and 256 colors.</li>
<li><b>Default installation language</b>: Default language for the installer. Use 'auto' for autodetection of the current language</li>
<li><b>Allow language selection</b>: Allow language selection. If this setting is enabled, the user will be required to specify the language for the installation</li>
<li><b>Wrap License File Text</b>: Wrap license file text displayed to the user</li>
<li><b>Splash screen delay</b>: Extra display time of the splash screen</li>
</ul>

<h3>Installer Settings</h3>
<ul>
<li><b>Require install by administrator</b>: Whether installation will require super user privileges (root on Linux, Administrator user on Windows and OS X). In all OSes but OS X this setting will prevent the installer from running if the user is not root or Administrator. In OS X, the regular authentication dialog window will be shown, asking the user for the administrator password so the installer can be run with root privileges</li>
<li><b>Installer Name</b>: Name of the installer created by the build process. If it contains ${product_shortname}, ${product_version}, ${platform_name} or ${platform_exec_suffix} they will be replaced by the appropriate values</li>
<li><b>CDROM files Directory</b>: Name of the directory that will contain the CDROM files created by the build process</li>
<li><b>Uninstaller directory</b>: Directory where the uninstaller will be created</li>
<li><b>Installation directory</b>: Default installation directory</li>
<li><b>Compression algorithm</b>: Compression algorithm that will be used to pack the files inside the installer. LZMA compression is available on Linux, Windows and OS-X platforms</li>
<li><b>Backup Directory</b>: Path to a directory where old files will be stored prior to overwritting</li>
<li><b>Installation Scope</b>: Whether to install Start Menu and Desktop links for All Users or for the current user</li>
</ul>

<h3>Script Settings</h3>
<ul>
<li><b>Post Install script</b>: Program that will be executed as the final installation step. The program or script must have execution permissions and you need to include it as part of the installation. Since you do not know beforehand where the user will decide to install the software, you need to prefix it with ${installdir}. You can also pass additional arguments to the script. For example : ${installdir}/bin/myscript.sh somevalue ${installdir}  will invoke the myscript.sh program with two arguments, 'somevalue' and the installation directory</li> 
<li><b>Post Install script arguments</b>: Command line arguments to pass to the Post Installation Script</li> 
<li><b>Show Post Install result?</b>: Whether to show the output result of the post installation script, even if it completed successfully</li> 
<li><b>Pre Uninstallation script</b>: Program that will be executed before uninstallation. The program or script must have execution permissions and you need to include it as part of the installation. Since you do not know beforehand where the user will decide to install the software, you need to prefix it with ${installdir}. You can also pass additional arguments to the script. For example : ${installdir}/bin/myscript.sh somevalue ${installdir}  will invoke the myscript.sh program with two arguments, 'somevalue' and the installation directory</li> 
<li><b>Pre Uninst. script arguments</b>: Command line arguments to pass to the Pre Uninstallation Script</li> 
</ul>

<p>Particularly important is the <b>Post Install script</b> setting.
It allows you to perform specific actions required to correctly finish installing
your product, such as initializing a database or starting a server in the background.</p>

<h3>Permissions</h3>
<p>Please note that these options only take effect when creating installers for Unix platforms from Windows.</p>
<ul>
<li><b>Default Unix File Permissions</b>: Default Unix file permissions in octal form</li> 
<li><b>Default Unix Directory Permissions</b>: Default Unix directory permissions in octal form</li> 
</ul>

<center><br /><b>Figure 18 : Customization screen</b><br /><br /><img src="images/customization.png" alt="Customization screen" > </center>



<h3>Additional Settings</h3>
<p>The installer supports a number of features that are not yet available through the GUI. For this, you will need
to edit the XML project file directly.</p>
<ul>
<li><b>readmeFileEncoding</b>: Readme file encoding. Default value: <b>iso8859-1</b>, valid values: <b>iso8859-1 iso8859-2 utf-8 cp1251 cp1252 ascii macRoman unicode</b>.</li> 
<li><b>licenseFileEncoding</b>: License file encoding. Default value: <b>iso8859-1</b>, valid values: <b>iso8859-1 iso8859-2 utf-8 cp1251 cp1252 ascii macRoman unicode</b>.</li> 
<li><b>deleteOnExit</b>: Whether to delete the installer binary once the installation has completed</li> 
<li><b>rebootRequired</b>: Whether to ask the user to reboot after installation is completed (Windows-specific option).</li> 
<li><b>installationLogFile</b>: This project property allows you to set an alternative path to store the installation log file. Please note that the installation log will only be written to the location specified once the installation has completed. Otherwise, it will still be available at the system's temporary directory (usually /tmp on Unix systems)</li>
<li><b>enableRollback</b>: Enable temporary backup of old files that will be saved in case of overwritting, and that will be restored if the installation fails. The implementation only handles files overwritten by the installer during the files installation step (i.e., all files specified under any of the  sections). It does not support rollback for files overwritten as a result of the execution of actions or scripts. This feature is enabled by default.</li> 
<li><b>rollbackBackupDirectory</b>: Path to a directory where old files will be stored prior to overwritting.</li> 
<li><b>removeLogFile</b>: This project property controls automatic deletion of the generated log file after installation. It is set to 0 by default. If set to 1, the installer will remove the log file.</li>
<li><b>defaultInstallationMode</b>: Default installation mode. Available installation modes can be found by running the installer from command line using the --help option.</li>
<li><b>productDisplayIcon</b>: Application Icon (.ico format) that will be shown in Add/Remove Programs on Windows.</li>
<li><b>disableSplashScreen</b>: Disable the initial splash screen.</li>
</ul>

<h2>Additional Installation Folders</h2>

<p>Most applications only install files under the installation directory ("Program Files" folder in the Files screen). It is possible,
however, to add additional folders to copy files and directories to, such as <code>/usr/bin</code> or <code>/etc/</code> by pressing the 
"Add Destination Folder" button in the Files screen.
If you need special permissions to write to the destination folders, you may need to require installation by root (see previous section)</p>



<h2>Shortcuts</h2>

<p>You can create application, document and URL shortcuts in the Files screen. Program shortcuts are special files
containing information such as a program to execute and an icon to display.

If you are distributing a GUI program that runs on Windows, KDE or Gnome, you can place a shortcut
 for your executable in the Desktop or in a folder and the associated icon will be displayed. When the user clicks on the icon,
the associated program, document or URL will be launched. Figure 19 shows the prompt you
get when adding an Application shortcut to your product installer. It has the following fields:</p>

<p><b>Common</b></p>
<ul>
<li><b>Shortcut text</b>: Shortcut text</li>
<li><b>Tooltip</b>: Tooltip text for the shortcut</li>
<li><b>Platforms</b>: Platforms in which this link shortcut will be created</li>
</ul>
<p><b>Unix settings</b></p>
<ul>
<li><b>Unix Icon</b>: GIF or PNG Image to use for the shortcut</li>
<li><b>Program to execute</b>: Program to execute, including command line arguments</li>
<li><b>Working directory</b>: Working directory for the program being executed</li>
</ul>
<p><b>Windows settings</b></p>
<ul>
<li><b>Windows Icon</b>: File containing .ico image</li>
<li><b>Program to execute</b>: Program to execute</li>
<li><b>Working directory</b>: Working directory for the program being executed</li>
</ul>

<p>Notice that the target program to execute must have been installed with your product, so the value for
<b>Program to execute</b> and/or <b>winExec</b>
should include a reference to the installation directory and look similar to:
<code>${installdir}/foo/bar/program</code>  where <code>foo/bar/program</code> is the path to your program relative to the installation directory. At 
installation time, <code>${installdir}</code> will be substituted by the appropriate value.</p>

<p>It is also possible to create shortcuts that point to directories, documents or URLs. Select the "Document" or "URL" option when creating a shortcut</p>

<p>On Windows, Start Menu and Desktop shortcuts are by default created for All Users, or for the current user in case there are not enough privileges.
InstallBuilder allows to modify this behavior via the project property &lt;installationScope&gt;, which can be
set to "auto" (default), "user" or "allusers".</p>

<center><br /><b>Figure 19 : Adding a shortcut</b><br /><br /><img src="images/shortcut.png" alt="Adding a shortcut" > </center>
<h2>Using the Command Line Interface</h2>

<p>You can build projects from a shell script or the command line issuing the following command:</p>

<table border="0" bgcolor="cccccc" width="75%"><tr border="0"><td border="0"><code><b>$</b> /home/user/installbuilder-5.1.1/bin/builder build /path/to/project.xml</code></td></tr></table>

<p>For example</p>

<table border="0" bgcolor="cccccc" width="75%"><tr border="0"><td border="0"><code><b>$</b> /home/user/installbuilder-5.1.1/bin/builder build /home/user/installbuilder-5.1.1/projects/project.xml</code></td></tr></table>

<p>will compile the Sample Project mentioned earlier in this document.</p>


<p>By default, it will build a Linux installer. You can pass an optional argument to the command line
to indicate the target platform. For example:</p>

<table border="0" bgcolor="cccccc" width="75%"><tr border="0"><td border="0"><code><b>$</b> /home/user/installbuilder-5.1.1/bin/builder build /home/user/installbuilder-5.1.1/projects/project.xml windows</code></td></tr></table>


<h2>RPM Integration</h2>

<p>BitRock InstallBuilder allows you to register the software installed with
the RPM package database.</p> 

<p>To enable RPM support add
&lt;registerWithPackageDatabase&gt;1&lt;/registerWithPackageDatabase&gt;
to your installer project file. This will register your installation
with the RPM database. From this point on, you will be able to query
data about your application and its installed files using your
distribution's rpm-based tools as with any other existing rpm
package. You will also be able to uninstall the application using your
distribution's rpm-based tools.</p>

<p>RPM database integration requires installation as root in an
RPM-based distribution. Otherwise, the setting will be ignored.</p>

<p>Additionally, to successfully register an RPM, the following tags
must be also present in the XML project file:</p>
<table border="0" bgcolor="fffaf0"><tr border="0"><td border="0"><pre>
    &lt;vendor&gt;Your Company Name&lt;/vendor&gt;
    &lt;summary&gt;Detailed description of your software&lt;/summary&gt;
    &lt;release&gt;0&lt;/release&gt;
    &lt;description&gt;A one-line description of your software&lt;/description&gt;
</pre></td></tr></table>

<p>The name of the RPM package registered will be ${product_shortname}-${product_version}-${release}</p>

<h2>The XML Project File</h2>

<p>BitRock InstallBuilder stores all the information about the installer project in an XML file, usually located under 
<code>/home/user/installbuilder-5.1.1/projects/</code> (or <code>C:\Users\user\Documents\InstallBuilder\projects</code> under Windows Vista).
The XML format of the file is designed to be reasonably easy to edit
by hand, allow automated manipulation using scripts and track changes using a
source control tool such as CVS. You can find a sample XML project file in the Appendix.
</p>
</div>
  </td></tr>
</table>
</td></tr>
</table>
</center>
</div>
</body>
    